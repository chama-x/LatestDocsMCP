<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON-RPC Debug Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            margin-right: 10px;
            padding: 8px 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        textarea {
            width: 100%;
            height: 150px;
            font-family: monospace;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>JSON-RPC Debug Tool</h1>
    <p>This page allows you to send custom JSON-RPC requests for debugging.</p>

    <div class="test-section">
        <h2>Custom JSON-RPC Request</h2>
        <textarea id="requestJson">{
  "jsonrpc": "2.0",
  "method": "ping",
  "params": {
    "message": "Hello from debug tool"
  },
  "id": 1
}</textarea>
        <div>
            <button id="sendRequest">Send Request</button>
        </div>
        <h3>Raw Request Sent:</h3>
        <pre id="rawRequest"></pre>
        <h3>Response Headers:</h3>
        <pre id="responseHeaders"></pre>
        <h3>Response:</h3>
        <pre id="responseResult"></pre>
    </div>

    <div class="test-section">
        <h2>Quick Tests</h2>
        <button id="pingTest">Test Ping</button>
        <button id="addDocTest">Test Add Doc</button>
        <button id="searchTest">Test Search</button>
    </div>

    <script>
        async function sendJsonRpc(requestBody) {
            document.getElementById('rawRequest').textContent = JSON.stringify(requestBody, null, 2);
            
            try {
                const response = await fetch('http://localhost:3000/rpc', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });
                
                // Display headers
                const headerDisplay = document.getElementById('responseHeaders');
                headerDisplay.textContent = '';
                response.headers.forEach((value, key) => {
                    headerDisplay.textContent += `${key}: ${value}\n`;
                });
                
                const data = await response.json();
                document.getElementById('responseResult').textContent = JSON.stringify(data, null, 2);
                return data;
            } catch (error) {
                document.getElementById('responseResult').textContent = `Error: ${error.message}`;
            }
        }

        // Custom request
        document.getElementById('sendRequest').addEventListener('click', async () => {
            const textArea = document.getElementById('requestJson');
            try {
                const requestBody = JSON.parse(textArea.value);
                await sendJsonRpc(requestBody);
            } catch (e) {
                document.getElementById('responseResult').textContent = `Error parsing JSON: ${e.message}`;
            }
        });
        
        // Quick tests
        document.getElementById('pingTest').addEventListener('click', async () => {
            await sendJsonRpc({
                jsonrpc: '2.0',
                method: 'ping',
                params: {
                    message: 'Quick ping test'
                },
                id: Date.now()
            });
        });
        
        document.getElementById('addDocTest').addEventListener('click', async () => {
            await sendJsonRpc({
                jsonrpc: '2.0',
                method: 'addDocument',
                params: {
                    document: {
                        id: 'debug-doc-1',
                        title: 'Debug Document',
                        body: 'This is a test document for debugging',
                        source: 'debug-page',
                        version: '1.0'
                    }
                },
                id: Date.now()
            });
        });
        
        document.getElementById('searchTest').addEventListener('click', async () => {
            await sendJsonRpc({
                jsonrpc: '2.0',
                method: 'searchDocuments',
                params: {
                    query: 'debug',
                    limit: 5
                },
                id: Date.now()
            });
        });
    </script>
</body>
</html> 
</html> 